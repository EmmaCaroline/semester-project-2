import{a as l}from"./authGuard-DgJQJooe.js";import{e as c,h as r,i as g}from"./update-C0ONWQeW.js";import"./index-CWKkjwGO.js";import"./loadingSpinner-D-kshPRo.js";console.log("views/update.js loaded");const o=document.forms.updateListing;if(!o)console.error("Update form not found on the page.");else{const i=new URLSearchParams(window.location.search).get("id");i?c(i).then(t=>{const e=t.data;e?(o.title.value=e.title||"",o.description.value=e.description||"",o.tags.value=e.tags?e.tags.join(", "):"",Array.isArray(e.media)&&e.media.length>0?e.media.forEach((a,n)=>{console.log(`Preloading media ${n+1}:`,a),r(a.url,a.alt,n)}):r()):console.error("No listing found for the provided ID.")}).catch(t=>{console.error("Error fetching post for editing:",t)}):console.error("Listing ID is missing from URL."),m(),o.addEventListener("submit",function(t){t.preventDefault();const e=new FormData(o),a={title:e.get("title"),description:e.get("description"),tags:e.get("tags").split(",").map(s=>s.trim()),media:[]};o.querySelectorAll(".media-input").forEach((s,d)=>{a.media.push({url:s.value,alt:`Image ${d+1}`})}),g(t)})}function m(){const i=document.getElementById("addImageButton");i?i.addEventListener("click",function(t){t.preventDefault(),console.log("Add image button clicked"),r()}):console.error("Add Image button is not found in the DOM.")}l();
